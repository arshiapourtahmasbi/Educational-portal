{% extends 'base.html' %}

{% block content %}
<div class="container">
    <h2>Enrolled Students - {{ course.title }}</h2>
    
    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Course Details</h5>
            <p class="card-text"><strong>Description:</strong> {{ course.description }}</p>
            <p class="card-text"><strong>Schedule:</strong></p>
            <ul class="list-group mb-3">
                {% for schedule in course.schedules.all %}
                    <li class="list-group-item">{{ schedule.get_schedule_display }}</li>
                {% empty %}
                    <li class="list-group-item">No schedules available</li>
                {% endfor %}
            </ul>
            <p class="card-text"><strong>Available Seats:</strong> {{ course.capacity }}</p>
            <p class="card-text">
                <strong>Price:</strong> 
                {% if course.price == 0 %}
                    Free
                {% else %}
                    ${{ course.price }}
                {% endif %}
            </p>
        </div>
    </div>

    <div class="card">
        <div class="card-body">
            <h5 class="card-title">Enrolled Students</h5>
            {% if enrollments %}
                <table class="table">
                    <thead>
                        <tr>
                            <th>Student Name</th>
                            <th>Email</th>
                            <th>Enrollment Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for enrollment in enrollments %}
                        <tr>
                            <td>{{ enrollment.student.get_full_name|default:enrollment.student.username }}</td>
                            <td>{{ enrollment.student.email }}</td>
                            <td>{{ enrollment.enrollment_date|date:"M d, Y" }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            {% else %}
                <p>No students are currently enrolled in this course.</p>
            {% endif %}
        </div>
    </div>
    
    <div>
        <a href="{% url 'created_courses' %}" class="btn btn-primary">Back to Courses</a>
    </div>
</div>
{% endblock %}